var Ne=Object.defineProperty;var Ke=(r,e,t)=>e in r?Ne(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var W=(r,e,t)=>Ke(r,typeof e!="symbol"?e+"":e,t);import{t as Y,a as k}from"../chunks/DFqQMoLK.js";import{s as j,h as L,q as Me,o as Oe,a as Re,b as Ue,z as f,a8 as ke,c as Ye,r as ce,d as Z,g as D,Y as $e,e as we,f as Te,p as He,a0 as Ae,Q as qe,ad as De,an as fe,ao as ee,v as ve,ap as Be,aq as Ve,ar as Ge,$ as Fe,as as Je,k as ze,at as Xe,au as Qe,W as We,av as je,aw as Ze,ax as er,ay as rr,az as tr,aA as ar,j as sr,a3 as nr,F as or,ak as H,ab as de,I as ir,ac as w,J as C,K as I,L as N,aB as _e,m as lr,G as me}from"../chunks/CqIGo7Tj.js";import{a as ur,l as cr,d as fr,e as he,s as re}from"../chunks/DxaVxCKD.js";import{i as te}from"../chunks/BxEyPEBM.js";import{o as vr}from"../chunks/C8xWq-eA.js";function dr(r,e){return e}function _r(r,e,t,a){for(var s=[],o=e.length,i=0;i<o;i++)Ge(e[i].e,s,!0);var m=o>0&&s.length===0&&t!==null;if(m){var p=t.parentNode;Fe(p),p.append(t),a.clear(),K(r,e[0].prev,e[o-1].next)}Je(s,()=>{for(var y=0;y<o;y++){var n=e[y];m||(a.delete(n.k),K(r,n.prev,n.next)),ze(n.e,!m)}})}function mr(r,e,t,a,s,o=null){var i=r,m={flags:e,items:new Map,first:null};{var p=r;i=L?j(Me(p)):p.appendChild(Oe())}L&&Re();var y=null,n=!1,v=ke(()=>{var u=t();return qe(u)?u:u==null?[]:Ae(u)});Ue(()=>{var u=f(v),h=u.length;if(n&&h===0)return;n=h===0;let d=!1;if(L){var x=i.data===Ye;x!==(h===0)&&(i=ce(),j(i),Z(!1),d=!0)}if(L){for(var A=null,_,g=0;g<h;g++){if(D.nodeType===8&&D.data===$e){i=D,d=!0,Z(!1);break}var $=u[g],c=a($,g);_=be(D,m,A,null,$,c,g,s,e,t),m.items.set(c,_),A=_}h>0&&j(ce())}L||hr(u,m,i,s,e,a,t),o!==null&&(h===0?y?we(y):y=Te(()=>o(i)):y!==null&&He(y,()=>{y=null})),d&&Z(!0),f(v)}),L&&(i=D)}function hr(r,e,t,a,s,o,i){var m=r.length,p=e.items,y=e.first,n=y,v,u=null,h=[],d=[],x,A,_,g;for(g=0;g<m;g+=1){if(x=r[g],A=o(x,g),_=p.get(A),_===void 0){var $=n?n.e.nodes_start:t;u=be($,e,u,u===null?e.first:u.next,x,A,g,a,s,i),p.set(A,u),h=[],d=[],n=u.next;continue}if(pr(_,x,g),(_.e.f&ee)!==0&&we(_.e),_!==n){if(v!==void 0&&v.has(_)){if(h.length<d.length){var c=d[0],l;u=c.prev;var E=h[0],b=h[h.length-1];for(l=0;l<h.length;l+=1)pe(h[l],c,t);for(l=0;l<d.length;l+=1)v.delete(d[l]);K(e,E.prev,b.next),K(e,u,E),K(e,b,c),n=c,u=b,g-=1,h=[],d=[]}else v.delete(_),pe(_,n,t),K(e,_.prev,_.next),K(e,_,u===null?e.first:u.next),K(e,u,_),u=_;continue}for(h=[],d=[];n!==null&&n.k!==A;)(n.e.f&ee)===0&&(v??(v=new Set)).add(n),d.push(n),n=n.next;if(n===null)continue;_=n}h.push(_),u=_,n=_.next}if(n!==null||v!==void 0){for(var T=v===void 0?[]:Ae(v);n!==null;)(n.e.f&ee)===0&&T.push(n),n=n.next;var R=T.length;if(R>0){var U=m===0?t:null;_r(e,T,U,p)}}ve.first=e.first&&e.first.e,ve.last=u&&u.e}function pr(r,e,t,a){Ve(r.v,e),r.i=t}function be(r,e,t,a,s,o,i,m,p,y){var n=(p&Xe)!==0,v=(p&Qe)===0,u=n?v?De(s):fe(s):s,h=(p&Be)===0?i:fe(i),d={i:h,v:u,k:o,a:null,e:null,prev:t,next:a};try{return d.e=Te(()=>m(r,u,h,y),L),d.e.prev=t&&t.e,d.e.next=a&&a.e,t===null?e.first=d:(t.next=d,t.e.next=d.e),a!==null&&(a.prev=d,a.e.prev=d.e),d}finally{}}function pe(r,e,t){for(var a=r.next?r.next.e.nodes_start:t,s=e?e.e.nodes_start:t,o=r.e.nodes_start;o!==a;){var i=We(o);s.before(o),o=i}}function K(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}const yr=Symbol("is custom element"),gr=Symbol("is html");function ye(r){if(L){var e=!1,t=()=>{if(!e){if(e=!0,r.hasAttribute("value")){var a=r.value;G(r,"value",null),r.value=a}if(r.hasAttribute("checked")){var s=r.checked;G(r,"checked",null),r.checked=s}}};r.__on_r=t,je(t),ur()}}function G(r,e,t,a){var s=Er(r);L&&(s[e]=r.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&r.nodeName==="LINK")||s[e]!==(s[e]=t)&&(e==="loading"&&(r[Ze]=t),t==null?r.removeAttribute(e):typeof t!="string"&&wr(r).includes(e)?r[e]=t:r.setAttribute(e,t))}function Er(r){return r.__attributes??(r.__attributes={[yr]:r.nodeName.includes("-"),[gr]:r.namespaceURI===er})}var ge=new Map;function wr(r){var e=ge.get(r.nodeName);if(e)return e;ge.set(r.nodeName,e=[]);for(var t,a=r,s=Element.prototype;s!==a;){t=tr(a);for(var o in t)t[o].set&&e.push(o);a=rr(a)}return e}function Ee(r,e,t=e){var a=ar();cr(r,"input",s=>{var o=s?r.defaultValue:r.value;if(o=ae(r)?se(o):o,t(o),a&&o!==(o=e())){var i=r.selectionStart,m=r.selectionEnd;r.value=o??"",m!==null&&(r.selectionStart=i,r.selectionEnd=Math.min(m,r.value.length))}}),(L&&r.defaultValue!==r.value||sr(e)==null&&r.value)&&t(ae(r)?se(r.value):r.value),nr(()=>{var s=e();ae(r)&&s===se(r.value)||r.type==="date"&&!s&&!r.value||s!==r.value&&(r.value=s??"")})}function ae(r){var e=r.type;return e==="number"||e==="range"}function se(r){return r===""?null:+r}const M={set:(r,e)=>new Promise((t,a)=>{chrome.storage.local.set(r,()=>{if(chrome.runtime.lastError)return a(chrome.runtime.lastError);t(),e==null||e()})}),get:(r,e)=>new Promise((t,a)=>{chrome.storage.local.get(r,s=>{if(chrome.runtime.lastError)return a(chrome.runtime.lastError);if(s[r])t(s[r]);else return a("No items found");e==null||e(s)})}),getAll:r=>new Promise(e=>{chrome.storage.local.get(null,t=>{r==null||r(t),e(t)})}),remove:(r,e)=>new Promise((t,a)=>{chrome.storage.local.remove(r,()=>{if(chrome.runtime.lastError)return a(chrome.runtime.lastError);t(),e==null||e()})}),clear:r=>new Promise((e,t)=>{chrome.storage.local.clear(()=>{if(chrome.runtime.lastError)return t(chrome.runtime.lastError);e(),r==null||r()})}),getBytesInUse:r=>new Promise((e,t)=>{chrome.storage.local.getBytesInUse(r,a=>{if(chrome.runtime.lastError)return t(chrome.runtime.lastError);e(a)})}),listen:r=>{chrome.storage.onChanged.addListener((e,t)=>{t==="local"&&r(e,t)})}},O={API_KEY:"apiKey",LIST_TOKEN:"listToken",LIST_SYMBOL:"listSymbol",CACHE_TOKEN_:"cacheToken_"},Tr=1e3*30;class Ar{constructor(e={}){W(this,"baseURL");W(this,"headers");this.baseURL=e.baseURL||"",this.headers=e.headers||{"Content-Type":"application/json"}}buildURL(e,t){const a=`${this.baseURL}${e}`;if(!t)return a;const s=new URLSearchParams(t).toString();return s?`${a}?${s}`:a}async request(e,t,a={}){const{params:s,headers:o,body:i,...m}=a,p=this.buildURL(t,s),y={...this.headers,...o},n=await fetch(p,{method:e,headers:y,body:i?JSON.stringify(i):void 0,...m}),v=n.headers.get("Content-Type");if(!n.ok){const u=v!=null&&v.includes("application/json")?await n.json():await n.text();throw new Error(`HTTP error! status: ${n.status} ${n.statusText}. ${JSON.stringify(u)}`)}return v!=null&&v.includes("application/json")?await n.json():await n.text()}get(e,t){return this.request("GET",e,t)}post(e,t,a){return this.request("POST",e,{...a,body:t})}put(e,t,a){return this.request("PUT",e,{...a,body:t})}delete(e,t){return this.request("DELETE",e,t)}}const br=new Ar({baseURL:"https://pro-api.coinmarketcap.com/v1",headers:{"Content-Type":"application/json"}}),Sr=async r=>{const e=await M.get(O.API_KEY);if(!e)throw new Error("No API key found");return await br.get("/cryptocurrency/quotes/latest",{params:{symbol:r},headers:{"X-CMC_PRO_API_KEY":e}})},Ir=r=>`https://s2.coinmarketcap.com/static/img/coins/64x64/${r}.png`;function Cr(r,{currencySymbol:e="",decimalSeparator:t=".",thousandSeparator:a=","}={}){if(typeof r!="number"||isNaN(r))return"";const s=Math.abs(r),o=r<0?"-":"";let i;s>=1e6?i=2:s>0&&s<1?i=4:i=2;const m=s.toFixed(i),[p,y]=m.split("."),n=p.replace(/\B(?=(\d{3})+(?!\d))/g,a),v=y?n+t+y:n;return`${o}${e}${v}`}const Lr=async(r,e,t,a)=>{await M.set({[O.API_KEY]:""}),w(e,!1),w(t,[],!0),w(a,[],!0)};var xr=Y('<form class="form-container-api-key"><h2>Coinmarketcap Tracker</h2> <input type="text" placeholder="Enter your Coinmarketcap API Key"> <button type="submit" id="submit-selected-symbol-btn">Add Coinmarketcap API Key</button></form>'),Pr=Y('<div class="notification-ui"> </div>'),Nr=Y('<div class="empty-state">No cryptocurrencies added yet. Add your first one above!</div>'),Kr=(r,e,t)=>e(f(t).symbol),Mr=Y('<li class="crypto-listing-item"><div class="crypto-listing-item-content"><img> <h3> </h3> <p class="crypto-listing-item-price"> </p></div> <button class="delete-token-btn">×</button></li>'),Or=Y("<ul></ul>"),Rr=Y('<div class="header-container"><h1>Coinmarketcap</h1> <button class="logout-btn"><span>×</span></button></div> <form class="form-container"><input type="text" placeholder="Enter a crypto symbol"> <button type="submit" id="submit-selected-symbol-btn">Add</button></form> <!> <div class="crypto-listings-container"><!></div>',1),Ur=Y('<div class="container"><!></div>');function Br(r,e){or(e,!0);let t=H(!0),a=H(""),s=H(""),o=H(de([])),i=H(de([])),m=H("");const p=async c=>{var U,B;const l=await Sr(c);if(!l)return;const E=(U=l.data)==null?void 0:U[c].quote.USD.price,b=(B=l.data)==null?void 0:B[c].id,T=Ir(b.toString()),R={price:E,img:T,symbol:c};f(o).push(R),v(c,R)},y=async()=>{try{return!!await M.get(O.API_KEY)}catch{return!1}},n=async()=>{await M.set({[O.LIST_SYMBOL]:f(i)})},v=async(c,l)=>{const E=Date.now()+Tr;await M.set({[`${O.CACHE_TOKEN_}${c}`]:{token:l,expireTime:E}})},u=async c=>{c.preventDefault();const l=f(s).trim().toUpperCase();w(i,[...f(i),l],!0),w(s,""),await p(l).then(()=>{n()}).catch(()=>{w(m,"Invalid symbol"),f(i).pop()})},h=async c=>{c.preventDefault(),await M.set({[O.API_KEY]:f(a)}),w(t,!0),await x(),w(a,"")},d=c=>{w(i,f(i).filter(l=>l!==c),!0),w(o,f(o).filter(l=>l.symbol!==c),!0),n()},x=async()=>{const c=await M.get(O.LIST_SYMBOL);w(i,Object.values(c),!0),await Promise.all(f(i).map(async l=>{const E=`${O.CACHE_TOKEN_}${l}`,{token:b,expireTime:T}=await M.get(E);b&&T?T<Date.now()?await p(l):f(o).push(b):await p(l)}))};vr(async()=>{w(t,await y(),!0),console.log(f(t)),f(t)&&await x()});var A=Ur(),_=C(A);{var g=c=>{var l=xr(),E=N(C(l),2);ye(E),_e(2),I(l),he("submit",l,h),Ee(E,()=>f(a),b=>w(a,b)),k(c,l)},$=c=>{var l=Rr(),E=lr(l),b=N(C(E),2);b.__click=[Lr,t,o,i],I(E);var T=N(E,2),R=C(T);ye(R),_e(2),I(T);var U=N(T,2);{var B=S=>{var P=Pr(),F=C(P,!0);I(P),me(()=>re(F,f(m))),k(S,P)};te(U,S=>{f(m)&&S(B)})}var ne=N(U,2),Se=C(ne);{var Ie=S=>{var P=Nr();k(S,P)},Ce=S=>{var P=Or();mr(P,21,()=>f(o),dr,(F,q)=>{var J=Mr(),z=C(J),X=C(z),Q=N(X,2),Le=C(Q,!0);I(Q);var oe=N(Q,2),xe=C(oe);I(oe),I(z);var Pe=N(z,2);Pe.__click=[Kr,d,q],I(J),me(V=>{var ie,le,ue;G(X,"src",(ie=f(q))==null?void 0:ie.img),G(X,"alt",(le=f(q))==null?void 0:le.symbol),re(Le,(ue=f(q))==null?void 0:ue.symbol),re(xe,`$${V??""}`)},[()=>{var V;return Cr((V=f(q))==null?void 0:V.price)}]),k(F,J)}),I(P),k(S,P)};te(Se,S=>{f(o).length===0?S(Ie):S(Ce,!1)})}I(ne),he("submit",T,u),Ee(R,()=>f(s),S=>w(s,S)),k(c,l)};te(_,c=>{f(t)?c($,!1):c(g)})}I(A),k(r,A),ir()}fr(["click"]);export{Br as component};
